<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumière Café - Reserva de Mesa</title>
    
    <link rel="stylesheet" href="reserva.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Caprasimo&family=Poppins:wght@400;500;700&family=Sora:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="reservation-body">

    <div class="reservation-container">
        
        <button class="back-button" onclick="goBack()">
            ← Voltar
        </button>

        <div class="logo-group">
            <img src="https://c.animaapp.com/2rCwzqnx/img/group@4x.png" alt="Lumière Café Logo" class="logo-image">
        </div>

        <div id="reservation-steps" class="reservation-box">
            
            <div id="step-1" class="step active">
                <p class="welcome-text">Bem-Vindo! Lumière Café</p>
                <h1 class="service-question">Qual serviço você deseja utilizar?</h1>
                <div id="service-options-container">
                    </div>
            </div>

            <div id="step-2" class="step hidden">
                <h2 class="step-title">Faça sua reserva</h2>
                
                <div class="reservation-image-placeholder"></div>

                <form id="reservation-form">
                    <div class="input-group-reserva">
                        <label for="date">Dia da reserva</label>
                        <input type="date" id="date" name="date" required>
                    </div>

                    <div class="input-group-reserva">
                        <label for="people">Pessoas</label>
                        <select id="people" name="people" required>
                            <option value="" disabled selected>Selecione o número de pessoas</option>
                            <option value="1">1 Pessoa</option>
                            <option value="2">2 Pessoas</option>
                            <option value="4">4 Pessoas</option>
                            <option value="6">6 Pessoas</option>
                        </select>
                    </div>
                    
                    <div class="input-group-reserva">
                        <label for="time">Horário</label>
                        <select id="time" name="time" required>
                            <option value="" disabled selected>Selecione um horário</option>
                            <option value="18:00">18:00</option>
                            <option value="19:30">19:30</option>
                            <option value="21:00">21:00</option>
                        </select>
                    </div>

                    <div class="input-group-reserva">
                        <label for="special-request">Precisa de algo especial? (Opcional)</label>
                        <textarea id="special-request" name="special-request" placeholder="Ex: Aniversário, restrições alimentares" rows="3"></textarea>
                    </div>

                    <p class="policy-text">
                        * Pedimos que chegue no máximo com 15 minutos de antecedência.
                    </p>
                    
                    <button type="button" class="btn primary btn-continue" onclick="nextStep(3)">Continuar</button>
                </form>
            </div>

            <div id="step-3" class="step hidden">
                <div class="confirmation-card">
                    <div class="confirmation-overlay"></div>
                    <div class="confirmation-content">
                        <h2 class="reservation-status">MESA RESERVADA</h2>
                        <p class="reservation-details-text">
                            Confirme os detalhes da sua reserva para prosseguir com a finalização.
                        </p>
                        <div class="detail-summary">
                        </div>
                        <button type="button" class="btn primary btn-confirm" onclick="finalConfirmation()">
                            Continuar
                        </button>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    
    <script>
        // --- CONFIGURAÇÃO SUPABASE (Seus dados) ---
        const SUPABASE_URL = 'https://isticmrrszpueieovlqq.supabase.co'; 
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlzdGljbXJyc3pwdWVpZW92bHFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4MzEwMjcsImV4cCI6MjA3OTQwNzAyN30.M3NNmuKrVFm-i4wQTHpVI0s-M3SCwHtB5CK93RZ2QL4'; 
        
        // Esta linha pode dar erro se o Supabase SDK não foi carregado
        // Tente remover 'supabase.' se o console reportar erro na linha
        // const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        // Ou mantenha se o SDK estiver no <head> como no seu código.
        
        // --- DADOS E REFERÊNCIAS ---
        const serviceOptions = [
            {
                id: 1,
                title: "Fazer reserva de mesa",
                description: "Escolha a data e venha ao café",
                icon: "https://c.animaapp.com/2rCwzqnx/img/icons8-reserva-50-1@2x.png",
                icon: "reserva.png",
                action: "nextStep(2)" 
                
            },
            {
                id: 2,
                title: "Ver eventos",
                description: "Vá para a página dos eventos",
                icon: "https://c.animaapp.com/2rCwzqnx/img/icons8-clapperboard-24-1@2x.png",
                 icon: "eventos.png",
                action: "alert('Funcionalidade de Eventos ainda não implementada.')"
            },
            {
                id: 3,
                title: "Ver cardápio",
                description: "Vá para a página do cardápio",
                icon: "https://c.animaapp.com/2rCwzqnx/img/icons8-card-pio-50-1@2x.png",
                 icon: "cardapio.png",
                action: "alert('Funcionalidade de Cardápio ainda não implementada.')"
            },
        ];

        // Certifique-se de que estas variáveis globais existem no escopo
        const steps = document.querySelectorAll('.step');
        let currentStep = 1;
        
        // --- FUNÇÃO QUE CRIA OS BOTÕES (AGORA DENTRO DO HTML) ---
        function renderServiceOptions() {
            // Obtemos a referência ao container APÓS o DOM ter carregado
            const container = document.getElementById('service-options-container'); 
            if (!container) return; // Proteção caso o container não seja encontrado
            
            let htmlContent = '';
            serviceOptions.forEach(service => {
                htmlContent += `
                    <button class="option-button" aria-label="${service.title}" onclick="${service.action}">
                        <img src="${service.icon}" alt="${service.title} Icon" class="option-icon">
                        <div class="option-content">
                            <h2 class="option-title">${service.title}</h2>
                            <p class="option-description">${service.description}</p>
                        </div>
                    </button>
                `;
            });
            container.innerHTML = htmlContent;
        }

        // --- FUNÇÕES DE NAVEGAÇÃO E LÓGICA (Simplificadas aqui) ---
        function nextStep(stepNumber) {
            // (Mantenha o restante do código das funções nextStep, goBack, 
            // validateStep2, updateSummary e finalConfirmation aqui)
            // ... [COLE O RESTANTE DAS SUAS FUNÇÕES AQUI] ...
            
            // Exemplo da nextStep para referência:
            if (stepNumber === 3) { if (!validateStep2()) { return; } updateSummary(); }
            steps.forEach(step => { step.classList.add('hidden'); step.classList.remove('active'); });
            const nextStepElement = document.getElementById(`step-${stepNumber}`);
            if (nextStepElement) {
                nextStepElement.classList.remove('hidden'); nextStepElement.classList.add('active'); currentStep = stepNumber;
            }
        }
        
        function goBack() { 
            if (currentStep > 1) { nextStep(currentStep - 1); } else { history.back(); }
        }
        
        // (Adicione o restante das funções aqui)
        function validateStep2() { /* ... */ return true; }
        function updateSummary() { /* ... */ }
        async function finalConfirmation() { /* ... */ }


        // ⚠️ INICIALIZAÇÃO GARANTIDA NO CARREGAMENTO DA PÁGINA ⚠️
        // Usamos DOMContentLoaded para garantir que o elemento existe
        document.addEventListener('DOMContentLoaded', renderServiceOptions);
        
        // Chamada imediata, caso o script seja carregado tarde
        renderServiceOptions(); 
    </script>
</body>
</html>
